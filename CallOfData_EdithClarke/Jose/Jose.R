library(data.table)
oda_per_capita <- data.table::fread("~/call-of-data_2017/data/Banco Mundial/ODA recibida per Capita.csv")

View(oda_per_capita)

for(cpo in as.character(1960:2015))
{
  print(cpo)
#  set(oda_per_capita, j=cpo, value=as.numeric(oda_per_capita[,(cpo), with=FALSE]))
}
oda_per_capita$"1960" <- as.numeric(oda_per_capita$"1960")
oda_per_capita$"1961" <- as.numeric(oda_per_capita$"1961")
oda_per_capita$"1962" <- as.numeric(oda_per_capita$"1962")
oda_per_capita$"1963" <- as.numeric(oda_per_capita$"1963")
oda_per_capita$"1964" <- as.numeric(oda_per_capita$"1964")
oda_per_capita$"1965" <- as.numeric(oda_per_capita$"1965")
oda_per_capita$"1966" <- as.numeric(oda_per_capita$"1966")
oda_per_capita$"1967" <- as.numeric(oda_per_capita$"1967")
oda_per_capita$"1968" <- as.numeric(oda_per_capita$"1968")
oda_per_capita$"1969" <- as.numeric(oda_per_capita$"1969")
oda_per_capita$"1970" <- as.numeric(oda_per_capita$"1970")
oda_per_capita$"1971" <- as.numeric(oda_per_capita$"1971")
oda_per_capita$"1972" <- as.numeric(oda_per_capita$"1972")
oda_per_capita$"1973" <- as.numeric(oda_per_capita$"1973")
oda_per_capita$"1974" <- as.numeric(oda_per_capita$"1974")
oda_per_capita$"1975" <- as.numeric(oda_per_capita$"1975")
oda_per_capita$"1976" <- as.numeric(oda_per_capita$"1976")
oda_per_capita$"1977" <- as.numeric(oda_per_capita$"1977")
oda_per_capita$"1978" <- as.numeric(oda_per_capita$"1978")
oda_per_capita$"1979" <- as.numeric(oda_per_capita$"1979")
oda_per_capita$"1980" <- as.numeric(oda_per_capita$"1980")
oda_per_capita$"1981" <- as.numeric(oda_per_capita$"1981")
oda_per_capita$"1982" <- as.numeric(oda_per_capita$"1982")
oda_per_capita$"1983" <- as.numeric(oda_per_capita$"1983")
oda_per_capita$"1984" <- as.numeric(oda_per_capita$"1984")
oda_per_capita$"1985" <- as.numeric(oda_per_capita$"1985")
oda_per_capita$"1986" <- as.numeric(oda_per_capita$"1986")
oda_per_capita$"1987" <- as.numeric(oda_per_capita$"1987")
oda_per_capita$"1988" <- as.numeric(oda_per_capita$"1988")
oda_per_capita$"1989" <- as.numeric(oda_per_capita$"1989")
oda_per_capita$"1990" <- as.numeric(oda_per_capita$"1990")
oda_per_capita$"1991" <- as.numeric(oda_per_capita$"1991")
oda_per_capita$"1992" <- as.numeric(oda_per_capita$"1992")
oda_per_capita$"1993" <- as.numeric(oda_per_capita$"1993")
oda_per_capita$"1994" <- as.numeric(oda_per_capita$"1994")
oda_per_capita$"1995" <- as.numeric(oda_per_capita$"1995")
oda_per_capita$"1996" <- as.numeric(oda_per_capita$"1996")
oda_per_capita$"1997" <- as.numeric(oda_per_capita$"1997")
oda_per_capita$"1998" <- as.numeric(oda_per_capita$"1998")
oda_per_capita$"1999" <- as.numeric(oda_per_capita$"1999")
oda_per_capita$"2000" <- as.numeric(oda_per_capita$"2000")
oda_per_capita$"2001" <- as.numeric(oda_per_capita$"2001")
oda_per_capita$"2002" <- as.numeric(oda_per_capita$"2002")
oda_per_capita$"2003" <- as.numeric(oda_per_capita$"2003")
oda_per_capita$"2004" <- as.numeric(oda_per_capita$"2004")
oda_per_capita$"2005" <- as.numeric(oda_per_capita$"2005")
oda_per_capita$"2006" <- as.numeric(oda_per_capita$"2006")
oda_per_capita$"2007" <- as.numeric(oda_per_capita$"2007")
oda_per_capita$"2008" <- as.numeric(oda_per_capita$"2008")
oda_per_capita$"2009" <- as.numeric(oda_per_capita$"2009")
oda_per_capita$"2010" <- as.numeric(oda_per_capita$"2010")
oda_per_capita$"2011" <- as.numeric(oda_per_capita$"2011")
oda_per_capita$"2012" <- as.numeric(oda_per_capita$"2012")
oda_per_capita$"2013" <- as.numeric(oda_per_capita$"2013")
oda_per_capita$"2014" <- as.numeric(oda_per_capita$"2014")
oda_per_capita$"2015" <- as.numeric(oda_per_capita$"2015")

oda_per_capita_4_13 <- oda_per_capita[,c(colnames(oda_per_capita)[1:2],as.character(2004:2013)),with=F]
colnames(oda_per_capita_4_13)[1:2] <- c('pais', 'cod_pais')

for(j in colnames(oda_per_capita_4_13))  set(oda_per_capita_4_13, which(is.na(oda_per_capita_4_13[[j]])), j, 0) # NAs a cero

View(oda_per_capita_4_13)
summary(oda_per_capita_4_13)

unique(oda_per_capita_4_13$`Country Name`)

fichname = "~/call-of-data_2017/data/Banco Mundial/oda_per_capita_4_13"
save(oda_per_capita_4_13, file=paste0(fichname, ".RData"))
write.table(oda_per_capita_4_13, file = paste0(fichname, ".csv"), append = F, row.names=F, col.names=T, quote=T, sep=",")

melt(oda_per_capita_4_13, 1:2, 3:12, variable.name='anyo', value.name = 'aod_per_capita_recibida')

poblacion <- fread("~/call-of-data_2017/data/poblacion.csv", header = T)
summary(poblacion)
length(colnames(poblacion))
sapply(poblacion, class)
poblacion2 <- cbind(poblacion[,c(1:2, 59),with=F], sapply(poblacion[,c(3:58),with=F], as.numeric))
poblacion2 <- melt(poblacion2, id.vars = c(1:3), measure.vars = (4:59), variable.name='anyo', value.name = 'poblacion')
View(poblacion2)

fichname <- '~/call-of-data_2017/data/poblacion_v2'
write.table(poblacion2, file = paste0(fichname, ".csv"), append = F, row.names=F, col.names=T, quote=T, sep=",")
